update temp_table
    set temp_table.ERROR_CODE = 'GENERAL_ENTITY_NOT_FOUND_ERROR',
	temp_table.ERROR_DETAILS = '{"administrationObjType": "MainObj"}'
	from {{temporaryTextTable MasterdataBusinessObject}} as temp_table,
	( select {{keyFieldsWithPrefix MasterdataBusinessObject 'temp_table'}}, temp_table.LANGUAGE
	       from {{temporaryTextTable MasterdataBusinessObject}} as temp_table
	       where temp_table.operation in ('Upsert')
	       and ( temp_table.error_code = '' or  temp_table.error_code is null )
  	  minus
	  	 ( select {{keyFieldsWithPrefix MasterdataBusinessObject 'temp_table'}}, temp_table.LANGUAGE
	        	from {{temporaryTextTable MasterdataBusinessObject}} as temp_table
				inner join {{mainTable MasterdataBusinessObject}} as main_table
				on {{keyFieldsConditionWithPrefixes MasterdataBusinessObject 'temp_table' 'main_table'}}
				and main_table._VALID_FROM <= TO_TIMESTAMP({{currentTimestamp MasterdataBusinessObject}}) and main_table._VALID_TO is null
				and temp_table.operation in ('Upsert')
				and ( temp_table.error_code = '' or  temp_table.error_code is null )
            union
            select {{keyFieldsWithPrefix MasterdataBusinessObject 'temp_table'}}, temp_table.LANGUAGE
                from {{temporaryTextTable MasterdataBusinessObject}} as temp_table
				inner join {{temporaryTable MasterdataBusinessObject}} as temp_main_table
				on {{keyFieldsConditionWithPrefixes MasterdataBusinessObject 'temp_table' 'temp_main_table'}}
				and temp_table.operation in ('Upsert')
				and ( temp_table.error_code = '' or  temp_table.error_code is null )
				and ( temp_main_table.error_code = '' or  temp_main_table.error_code is null )
                and temp_main_table.operation in ('Create', 'Upsert')
           )
	) as result
	where {{keyFieldsConditionWithPrefixes MasterdataBusinessObject 'temp_table' 'result'}}
    and temp_table.LANGUAGE = result.LANGUAGE
	and temp_table.operation = 'Upsert'
	and ( temp_table.error_code = '' or  temp_table.error_code is null )